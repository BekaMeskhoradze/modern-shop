{% extends "core/base.html" %}
{% load static %}
{% block title %}Order #{{ order.id }} — Modern Shop{% endblock %}
{% block content %}
    <section class="max-w-5xl mx-auto">
        <div class="mb-6 flex items-center justify-between">
            <h1 class="text-2xl font-semibold">Order #{{ order.id }}</h1>
            <a href="{% url 'orders:my_orders' %}"
               class="px-3 py-2 rounded-xl border card">Back to orders</a>
        </div>
        <div class="grid md:grid-cols-3 gap-6">
            <!-- Items -->
            <div class="md:col-span-2 space-y-4">
                {% for it in order.items.all %}
                    <div class="rounded-2xl border card p-4 flex items-center gap-4">
                        {% if it.product.main_image %}
                            <img src="{{ it.product.main_image.url }}"
                                 alt=""
                                 class="w-16 h-16 rounded-lg object-cover border"
                                 style="border-color: var(--line)" />
                        {% else %}
                            <img src="{% static 'img/placeholder.svg' %}"
                                 alt=""
                                 class="w-16 h-16 rounded-lg object-cover border"
                                 style="border-color: var(--line)" />
                        {% endif %}
                        <div class="flex-1 min-w-0">
                            <div class="font-medium truncate">{{ it.product.name }}</div>
                            <div class="text-sm muted mt-0.5">
                                {% if it.size %}Size: {{ it.size.size.name }} ·{% endif %}
                                Price (snapshot): {{ it.price }}
                            </div>
                        </div>
                        <div class="w-28 text-right text-sm">
                            <div class="font-semibold">{{ it.quantity }} × {{ it.price }}</div>
                        </div>
                    </div>
                {% empty %}
                    <div class="rounded-2xl border card p-6 text-center muted">No items in this order.</div>
                {% endfor %}
            </div>
            <!-- Summary -->
            <aside class="rounded-2xl border card p-4 h-fit">
                <div class="space-y-2 text-sm">
                    <div class="flex justify-between">
                        <span class="muted">Total</span>
                        <span class="font-semibold">{{ order.total_price }}</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="muted">Payment</span>
                        <span class="uppercase">{{ order.payment_provider }}</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="muted">Placed</span>
                        <span>{{ order.created_at|date:"Y-m-d H:i" }}</span>
                    </div>
                </div>
            </aside>
        </div>
    </section>
{% endblock %}
